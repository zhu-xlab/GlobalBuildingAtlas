<!DOCTYPE html>
<html lang="en">

<head>
  <title>Global Building Footprint</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="./lib/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="./lib/bootstrap/4.4.1/css/bootstrap.min.css">
  <script src="./lib/bootstrap/4.4.1/js/bootstrap.min.js"></script>
  <script src="./lib/popper/1.16.0/umd/popper.min.js"></script>
  <script src="./lib/leaflet/leaflet.js"></script> 
  <link rel="stylesheet" href="./lib/leaflet/leaflet.css"/>
  <script src="./lib/requirejs/2.3.6/require.js"></script>
  <script src="./lib/leaflet_side_by_side/leaflet-side-by-side.js"></script>
  <script src="https://cdn.osmbuildings.org/classic/0.2.2b/OSMBuildings-Leaflet.js"></script>

  <style>
      html, body, #map {
          padding: 0;
          margin: 0;
          height: 96.5%;
          width: 100%;
      }
  </style>
  <style>
    .jumbotron {
    !background: #a52c644a;
    !text-align: center;
    padding-top: 10px;
    padding-bottom:5px;
    margin-top: 5px;
    margin-bottom: 8px;
    }
    .jumbotron h2{
    !margin-top:90%;
    left:30px;
    padding-top: 15px;
    font-size:30px;
    color:#0065bd;
    }
    .jumbotron h4{
    left:30px;
    font-size:20px;
    color:#64a0c8;
    }
  </style>
</head>

<body>


<div class="jumbotron bg-gradient-info text-info jumbotron-image shadow">
  <h2> Global Building Footprint <img src="figures/tum_dlr_erc.png" class="float-right mr-2 top" alt="Responsive image" style="width:205px;height:56px;"> </h2>
  <h4> ERC So2Sat Project </h4>
</div>


<div id="map"></div>
<script type="text/javascript">

  // Base layers

  // Google Map
  var googleMap = L.tileLayer('http://mt1.google.com/vt/lyrs=m@207000000&src=app&x={x}&y={y}&z={z}&s=Galile', {attribution: '&copy; Data Science in Earth Observation, TUM & DLR contributors, &copy; <a href="http://www.google.com">Google</a>'});

  // Google Satellite
  var googleSat = L.layerGroup([
  L.tileLayer('http://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}&s=Gali',  {attribution: '&copy; Data Science in Earth Observation, TUM & DLR contributors, &copy; <a href="http://www.google.com">Google</a>'}),
  L.tileLayer('http://mt1.google.com/vt/imgtp=png32&lyrs=h@207000000&x={x}&y={y}&z={z}&s=Galil')
            ]);

  //  OpenStreetMap
  var osm = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {attribution: '&copy; Data Science in Earth Observation, TUM & DLR contributors, &copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'});

  //  CartoDB Positron
  var cartodb = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {attribution: '&copy; Data Science in Earth Observation, TUM & DLR contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'});

  //  OSM Toner
  var toner = L.tileLayer('http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png', {attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'});

  //  White background
  var white = L.tileLayer("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAAA1BMVEX///+nxBvIAAAAH0lEQVQYGe3BAQ0AAADCIPunfg43YAAAAAAAAAAA5wIhAAAB9aK9BAAAAABJRU5ErkJggg==");
  
  // Overlay layers
  var lczLayer = L.tileLayer('./{z}/{x}/{y}.png', {tms: true, opacity: 0.7, attribution: ""});

  // Building Footprint layers 
  // var bfLayer = L.tileLayer('afr/{z}/{x}/{y}.png', {tms: true, opacity: 0.7, attribution: "", minZoom: 2, maxZoom: 15});
  // url = '/home/fahong/Code/planettool/planettools/demo/htmls/osm_buildings/web_vrt_3_africa'
  // url = '/home/Code/planettool/planettools/demo/htmls/osm_buildings/web_vrt_1-5_africa'
  url = 'raster_bf/'
  var bfLayer = L.tileLayer(url + '{z}/{x}/{y}.png', {tms: true, opacity: 0.7, attribution: "", minZoom: 2, maxZoom: 15});

  // Global Urban Footprint layers (2012)
  var gufLayer = L.tileLayer('guf/{z}/{x}/{y}.png', {tms: true, opacity: 0.7, attribution: "", minZoom: 2, maxZoom: 15});

  // World settlement layers (2015)
  var wsfLayer = L.tileLayer('wsf2015/{z}/{x}/{y}.png', {tms: true, opacity: 0.7, attribution: "", minZoom: 2, maxZoom: 15});

  // Proc Group
  var polysProcGroup = new L.layerGroup();

  //var filename;

  //fetch('polysProc.txt')
  //.then(response => response.text())
  //.then(data => filename=data);
  // console.log(filename);})
  //.then(() => console.log(filename))

  //var filesArray;
  //setTimeout(() => {console.log(typeof filename); filesArray = filename.split('\n');}, 100);

  //setTimeout(() => {console.log(filesArray);}, 100);

  $.getJSON("meta/procStatus/procTiles.geojson", function (r) {
  L.geoJSON(r, { color: 'Red', weight: 1}).addTo(polysProcGroup);
  });
  

  // side by side
  //var sbs = L.control.sideBySide(cartodb, osm);
  
  // Map
  var map = L.map('map', {
            center: [39.8647391, 116.2840038],
            // center: [29.985008,31.437712],
            // center: [43.484873,-5.268479],
            zoom: 16,
            minZoom: 2,
            maxZoom: 18,
            layers: [cartodb]
        });

  var basemaps = {"Google Map": googleMap, "Google Satellite": googleSat, "OpenStreetMap": osm, "CartoDB Positron": cartodb, "Stamen Toner": toner, "Without background": white};
  
  var overlaymaps = {"Building Footprint": bfLayer, "GUF": gufLayer, "World Settlement Footprint": wsfLayer, "Proc Status": polysProcGroup};

  L.control.layers(basemaps, overlaymaps, {}, {position: "topright"}).addTo(map);

  L.control.scale().addTo(map);

  // json_url = 'poly_bf_v2/{z}/{x}/{y}.geojson'
  // json_url = 'poly_bf_v2/{z}/{x}/{y}.geojson'
  // json_url = 'global3D_figure/{z}/{x}/{y}.geojson'
  // json_url = 'poly_bf_basemap_sample/{z}/{x}/{y}.geojson'
  // var osmb = new OSMBuildings(map);
  // osmb.load(json_url);

</script>

</body>
</html>
